<!--
æˆ‘çš„é¡µé¢ - ç”¨æˆ·ä¸ªäººèµ„æ–™æ¨¡å—

ä¸Šæ¸¸ä¾èµ–ï¼šmy.jsé¡µé¢é€»è¾‘ï¼Œmy.wxssæ ·å¼æ–‡ä»¶
å…¥å£ï¼šé€šè¿‡ç”¨æˆ·æ˜µç§°ç‚¹å‡»è·³è½¬è‡³/pages/my/my
ä¸»è¦åŠŸèƒ½ï¼šå±•ç¤ºç”¨æˆ·åŸºæœ¬ä¿¡æ¯ã€æˆå°±æ•°ã€ç§°å·åˆ—è¡¨ã€ç§¯åˆ†ç­‰æ•°æ®
è¾“å‡ºï¼šæ¸²æŸ“ç”¨æˆ·ä¸ªäººèµ„æ–™ç•Œé¢ï¼Œè§¦å‘è¿”å›äº‹ä»¶å¤„ç†å™¨

é‡è¦ï¼šæ¯å½“æ‰€å±çš„ä»£ç å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¿…é¡»å¯¹ç›¸åº”çš„æ–‡æ¡£è¿›è¡Œæ›´æ–°æ“ä½œï¼
-->
<!--pages/my/my.wxml-->
<view class="my-container">
  <!-- ç”¨æˆ·ä¿¡æ¯ -->
  <view class="profile-card">
    <view class="profile-header">
      <view class="profile-avatar">
        <text wx:if="{{!userInfo.avatarUrl}}">å¤´åƒ</text>
        <image wx:if="{{userInfo.avatarUrl}}" src="{{userInfo.avatarUrl}}" mode="aspectFill"></image>
      </view>
      <view class="profile-info">
        <view wx:if="{{isEditingNickname || !userInfo.nickName || userInfo.nickName.startsWith('åè¯ˆå…ˆé”‹')}}" class="nickname-edit">
          <input 
            class="profile-name-input"
            type="text" 
            placeholder="è¾“å…¥æ˜µç§°"
            bindblur="onNicknameBlur"
            bindconfirm="onNicknameConfirm"
            value="{{tempNickname}}"
          />
          <text class="uid-hint" wx:if="{{userInfo.uid}}">UID: {{userInfo.uid}}</text>
        </view>
        <view wx:else class="profile-name-container">
          <view class="profile-name">{{userInfo.nickName}}</view>
          <text class="edit-nickname-btn" bindtap="startEditNickname">âœï¸</text>
          <text class="uid-text" wx:if="{{userInfo.uid}}">UID: {{userInfo.uid}}</text>
        </view>
        <view class="profile-sub">{{userInfo.nickName ? 'åè¯ˆå­¦ä¹ è€…' : 'å®Œå–„æ˜µç§°åå±•ç¤º'}}</view>
      </view>
    </view>

    <view class="profile-stats">
      <view class="stat-item">
        <view class="stat-value">{{signDays}}</view>
        <view class="stat-label">è¿ç»­ç­¾åˆ°</view>
      </view>
      <view class="stat-item clickable" bindtap="navigateToPoints">
        <view class="stat-value">{{points}}</view>
        <view class="stat-label">ç§¯åˆ†</view>
        <text class="click-hint">â€º</text>
      </view>
      <view class="stat-item">
        <view class="stat-value">{{achievements}}</view>
        <view class="stat-label">æˆå°±æ•°</view>
      </view>
      <view class="stat-item">
        <view class="stat-value">{{totalReadCount}}</view>
        <view class="stat-label">é˜…è¯»æ–‡ç« </view>
      </view>
    </view>
  </view>

  <!-- ç§°å·åˆ—è¡¨ -->
  <view class="titles-card">
    <view class="section-title">å·²è·å¾—ç§°å·</view>
    <view class="title-stats">å·²æ‹¥æœ‰ {{titleStats.owned}} Â· å·²ä½©æˆ´ {{titleStats.equipped}}</view>
    <view wx:if="{{displayTitles.length === 0}}" class="empty-text">æš‚æ— ç§°å·ï¼Œç»§ç»­åŠªåŠ›è§£é”å§</view>
    <view wx:else class="title-list">
      <view wx:for="{{displayTitles}}" wx:key="titleId" class="title-item {{item.isEquipped ? 'equipped' : ''}}">
        <view class="title-icon">{{item.icon}}</view>
        <view class="title-info">
          <view class="title-name">{{item.name}}</view>
          <view class="title-desc">{{item.desc}}</view>
        </view>
        <view class="title-badge {{item.rarity}}">{{item.rarity}}</view>
      </view>
    </view>
  </view>

  <!-- v3ï¼šä¸»é¡µå±•ç¤ºæˆå°± -->
  <view class="titles-card">
    <view class="section-title">ä¸»é¡µå±•ç¤ºæˆå°±</view>
    <view class="title-stats">å·²é€‰æ‹© {{displayAchievements.length}}/6</view>
    <view wx:if="{{displayAchievements.length === 0}}" class="empty-text">æš‚æ— å±•ç¤ºæˆå°±ï¼Œå¯åœ¨â€œæˆ‘çš„æˆå°±â€ä¸­è®¾ç½®</view>
    <view wx:else class="title-list">
      <view wx:for="{{displayAchievements}}" wx:key="id" class="title-item">
        <view class="title-icon">{{item.icon}}</view>
        <view class="title-info">
          <view class="title-name">{{item.title}}</view>
          <view class="title-desc">{{item.desc}}</view>
        </view>
      </view>
    </view>
    <view class="menu-card" bindtap="navigateToAchievements">
      <view class="menu-item">
        <view class="menu-icon">ğŸ†</view>
        <view class="menu-content">
          <view class="menu-title">ç®¡ç†å±•ç¤ºæˆå°±</view>
          <view class="menu-desc">åœ¨â€œæˆ‘çš„æˆå°±â€ä¸­è®¾ç½®ä¸»é¡µå±•ç¤ºå†…å®¹</view>
        </view>
        <view class="menu-arrow">â€º</view>
      </view>
    </view>
  </view>

  <!-- å­¦ä¹ è®°å½•å…¥å£ -->
  <view class="menu-card" bindtap="navigateToLearningRecords">
    <view class="menu-item">
      <view class="menu-icon">ğŸ“š</view>
      <view class="menu-content">
        <view class="menu-title">å­¦ä¹ è®°å½•</view>
        <view class="menu-desc">æŸ¥çœ‹é˜…è¯»å†å²å’Œå­¦ä¹ è¿›åº¦</view>
      </view>
      <view class="menu-arrow">â€º</view>
    </view>
  </view>

  <!-- ç§¯åˆ†å•†åŸå…¥å£ -->
  <view class="menu-card" bindtap="navigateToPoints">
    <view class="menu-item">
      <view class="menu-icon">â­</view>
      <view class="menu-content">
        <view class="menu-title">ç§¯åˆ†å•†åŸ</view>
        <view class="menu-desc">ä½¿ç”¨ç§¯åˆ†å…‘æ¢ç²¾ç¾ç¤¼å“å’Œé“å…·</view>
      </view>
      <view class="menu-arrow">â€º</view>
    </view>
  </view>

  <!-- æˆ‘çš„èƒŒåŒ…å…¥å£ -->
  <view class="menu-card" bindtap="navigateToBackpack">
    <view class="menu-item">
      <view class="menu-icon">ğŸ’</view>
      <view class="menu-content">
        <view class="menu-title">æˆ‘çš„èƒŒåŒ…</view>
        <view class="menu-desc">æŸ¥çœ‹å·²å…‘æ¢çš„å•†å“</view>
      </view>
      <view class="menu-arrow">â€º</view>
    </view>
  </view>
</view>
