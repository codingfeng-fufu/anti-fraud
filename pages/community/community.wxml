<!--
ç¤¾åŒºé¡µé¢ - ç¤¾åŒºæ¨¡å— (v3)

ä¸Šæ¸¸ä¾èµ–ï¼šcommunity.jsé¡µé¢é€»è¾‘ï¼Œcommunity.wxssæ ·å¼æ–‡ä»¶
å…¥å£ï¼šTabé¡µ /pages/community/community
ä¸»è¦åŠŸèƒ½ï¼šå±•ç¤ºå¸–å­æµã€è·³è½¬å‘å¸–ä¸å¸–å­è¯¦æƒ…
è¾“å‡ºï¼šæ¸²æŸ“ç¤¾åŒºå¸–å­åˆ—è¡¨

é‡è¦ï¼šæ¯å½“æ‰€å±çš„ä»£ç å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¿…é¡»å¯¹ç›¸åº”çš„æ–‡æ¡£è¿›è¡Œæ›´æ–°æ“ä½œï¼
-->
<!--pages/community/community.wxml-->
<view class="community-container">
  <view class="top-bar">
    <view class="title">ç¤¾åŒº</view>
    <button class="create-btn" bindtap="goCreate">å‘å¸–</button>
  </view>

  <scroll-view scroll-y class="list" bindscrolltolower="loadMore">
    <view wx:if="{{posts.length === 0 && !loading}}" class="empty">
      <text class="empty-icon">ğŸ“</text>
      <view class="empty-text">æš‚æ— å¸–å­ï¼Œå¿«æ¥å‘å¸ƒç¬¬ä¸€æ¡å§</view>
    </view>

    <view wx:for="{{posts}}" wx:key="_id" class="post-card" bindtap="goDetail" data-id="{{item._id}}">
      <view class="post-header">
        <image class="avatar" wx:if="{{item.authorAvatarUrl}}" src="{{item.authorAvatarUrl}}" mode="aspectFill" catchtap="goProfile" data-uid="{{item.authorUid}}"></image>
        <view class="avatar placeholder" wx:else catchtap="goProfile" data-uid="{{item.authorUid}}">ğŸ‘¤</view>
        <view class="meta">
          <view class="name">{{item.authorNickName || 'æœªè®¾ç½®æ˜µç§°'}}</view>
          <view class="time">{{item.createdAtText}}</view>
        </view>
      </view>

      <view class="content" wx:if="{{item.content}}">{{item.content}}</view>

      <view class="images" wx:if="{{item.images && item.images.length > 0}}">
        <image wx:for="{{item.images}}" wx:key="*this" class="img" src="{{item}}" mode="aspectFill"></image>
      </view>

      <view class="footer">
        <text class="count">ğŸ’¬ {{item.commentCount || 0}}</text>
      </view>
    </view>

    <view wx:if="{{loading}}" class="loading">åŠ è½½ä¸­...</view>
    <view wx:if="{{!hasMore && posts.length > 0}}" class="no-more">æ²¡æœ‰æ›´å¤šäº†</view>
  </scroll-view>
</view>
