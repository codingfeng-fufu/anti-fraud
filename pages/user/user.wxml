<!--
用户管理页面 - 个人中心模块

上游依赖：user.js页面逻辑，user.wxss样式文件
入口：页面路由跳转至/pages/user/user
主要功能：用户信息展示与编辑、签到功能、积分和成就统计、页面导航
输出：渲染用户界面，触发JS事件处理器

重要：每当所属的代码发生变化时，必须对相应的文档进行更新操作！
-->
<!--pages/user/user.wxml-->
<view class="user-container">
  <!-- 用户信息头部 -->
  <view class="user-header">
    <view class="user-info">
      <!-- 使用微信官方头像选择器 -->
      <button class="avatar-wrapper" open-type="chooseAvatar" bindchooseavatar="onChooseAvatar">
        <view class="user-avatar">
          <text wx:if="{{!userInfo.avatarUrl}}">👤</text>
          <image wx:if="{{userInfo.avatarUrl}}" src="{{userInfo.avatarUrl}}" mode="aspectFill"></image>
        </view>
      </button>
      <view class="user-details">
        <!-- 使用微信官方昵称输入框 -->
        <input 
          wx:if="{{!userInfo.nickName}}"
          class="user-name-input"
          type="nickname" 
          placeholder="输入昵称"
          bindchange="onNicknameChange"
        />
        <view wx:else class="user-name">{{userInfo.nickName}}</view>
        <view class="user-status">{{userInfo.nickName ? '开启反诈学习之旅 ✨' : '完善信息开启反诈学习之旅 ✨'}}</view>
      </view>
    </view>

    <!-- 数据统计卡片 -->
    <view class="user-stats">
      <view class="stat-item">
        <view class="stat-value">{{signDays}}</view>
        <view class="stat-label">连续签到</view>
      </view>
      <view class="stat-item">
        <view class="stat-value">{{points}}</view>
        <view class="stat-label">我的积分</view>
      </view>
      <view class="stat-item">
        <view class="stat-value">{{achievements}}</view>
        <view class="stat-label">获得成就</view>
      </view>
    </view>
  </view>

  <!-- 功能菜单 -->
  <view class="user-menu">
    <view class="menu-item" bindtap="handleSignIn">
      <view class="menu-left">
        <text class="menu-icon">📅</text>
        <text class="menu-label">每日签到</text>
      </view>
      <view class="menu-right">
        <text class="menu-badge" wx:if="{{!todaySigned}}">未签到</text>
        <text class="menu-badge signed" wx:if="{{todaySigned}}">已签到</text>
        <text class="menu-arrow">›</text>
      </view>
    </view>
    <view class="menu-item" bindtap="navigateTo" data-url="/pages/achievements/achievements">
      <view class="menu-left">
        <text class="menu-icon">🏆</text>
        <text class="menu-label">我的成就</text>
      </view>
      <text class="menu-arrow">›</text>
    </view>
    <view class="menu-item" bindtap="navigateTo" data-url="/pages/points/points">
      <view class="menu-left">
        <text class="menu-icon">⭐</text>
        <text class="menu-label">积分商城</text>
      </view>
      <text class="menu-arrow">›</text>
    </view>
    <view class="menu-item" bindtap="navigateTo" data-url="/pages/learning/learning">
      <view class="menu-left">
        <text class="menu-icon">📖</text>
        <text class="menu-label">学习记录</text>
      </view>
      <text class="menu-arrow">›</text>
    </view>
  </view>

  <!-- 设置菜单 -->
  <view class="user-menu">
    <view class="menu-item" bindtap="navigateTo" data-url="/pages/settings/settings">
      <view class="menu-left">
        <text class="menu-icon">⚙️</text>
        <text class="menu-label">设置</text>
      </view>
      <text class="menu-arrow">›</text>
    </view>
    <view class="menu-item" bindtap="navigateTo" data-url="/pages/feedback/feedback">
      <view class="menu-left">
        <text class="menu-icon">❓</text>
        <text class="menu-label">帮助与反馈</text>
      </view>
      <text class="menu-arrow">›</text>
    </view>
    <view class="menu-item" bindtap="navigateTo" data-url="/pages/about/about">
      <view class="menu-left">
        <text class="menu-icon">ℹ️</text>
        <text class="menu-label">关于我们</text>
      </view>
      <text class="menu-arrow">›</text>
    </view>
  </view>
</view>

