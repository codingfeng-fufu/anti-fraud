<!--
ç§¯åˆ†å•†åŸé¡µé¢ - ç§¯åˆ†å…‘æ¢æ¨¡å—

ä¸Šæ¸¸ä¾èµ–ï¼špoints.jsé¡µé¢é€»è¾‘ï¼Œpoints.wxssæ ·å¼æ–‡ä»¶
å…¥å£ï¼šé¡µé¢è·¯ç”±è·³è½¬è‡³/pages/points/points
ä¸»è¦åŠŸèƒ½ï¼šå±•ç¤ºå¯å…‘æ¢å•†å“ã€ç§¯åˆ†ä½™é¢ã€åˆ†ç±»ç­›é€‰ã€å…‘æ¢æ“ä½œ
è¾“å‡ºï¼šæ¸²æŸ“ç§¯åˆ†å•†åŸç•Œé¢ï¼Œè§¦å‘JSäº‹ä»¶å¤„ç†å™¨

é‡è¦ï¼šæ¯å½“æ‰€å±çš„ä»£ç å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¿…é¡»å¯¹ç›¸åº”çš„æ–‡æ¡£è¿›è¡Œæ›´æ–°æ“ä½œï¼
-->
<!--pages/points/points.wxml-->
<view class="points-container">
  <!-- é¡¶éƒ¨å¯¼èˆª -->
  <view class="page-header">
    <view class="header-left" bindtap="goBack">
      <text class="back-icon">â€¹</text>
    </view>
    <view class="header-title">ç§¯åˆ†å•†åŸ</view>
    <view class="header-right" bindtap="viewRecords">
      <text class="record-btn">è®°å½•</text>
    </view>
  </view>

  <!-- ç§¯åˆ†å¡ç‰‡ -->
  <view class="points-card">
    <view class="points-content">
      <view class="points-icon">â­</view>
      <view class="points-info">
        <view class="points-label">æˆ‘çš„ç§¯åˆ†</view>
        <view class="points-value">{{userPoints}}</view>
      </view>
      <button class="get-points-btn" bindtap="getMorePoints">
        è·å–ç§¯åˆ†
      </button>
    </view>
  </view>

  <!-- åˆ†ç±»ç­›é€‰ -->
  <view class="category-filter">
    <view class="filter-item {{currentCategory === 'all' ? 'active' : ''}}" 
          bindtap="filterCategory" data-category="all">
      å…¨éƒ¨
    </view>
    <view class="filter-item {{currentCategory === 'virtual' ? 'active' : ''}}" 
          bindtap="filterCategory" data-category="virtual">
      è™šæ‹Ÿå•†å“
    </view>
    <view class="filter-item {{currentCategory === 'tool' ? 'active' : ''}}" 
          bindtap="filterCategory" data-category="tool">
      é“å…·å¡
    </view>
    <view class="filter-item {{currentCategory === 'physical' ? 'active' : ''}}" 
          bindtap="filterCategory" data-category="physical">
      å®ä½“å•†å“
    </view>
  </view>

   <!-- ç§°å·å…‘æ¢ä¸“åŒº -->
   <view class="title-exchange-section" wx:if="{{titleProducts && titleProducts.length > 0}}">
     <view class="section-title">ç§°å·å…‘æ¢</view>
     <view class="title-products">
       <view wx:for="{{titleProducts}}" wx:key="id" class="title-product-item">
         <view class="title-icon">{{item.icon}}</view>
         <view class="title-content">
           <view class="title-name">{{item.name}}</view>
           <view class="title-desc">{{item.desc}}</view>
           <view class="title-rarity {{item.rarity}}">{{item.rarity}}</view>
         </view>
         <button class="exchange-btn {{userPoints < item.points || item.owned ? 'disabled' : ''}}"
                 bindtap="exchangeTitle"
                 data-id="{{item.titleId}}"
                 disabled="{{userPoints < item.points || item.owned}}">
           {{item.owned ? 'å·²è·å¾—' : userPoints < item.points ? 'ç§¯åˆ†ä¸è¶³' : 'å…‘æ¢'}}
         </button>
       </view>
     </view>
   </view>

   <!-- å•†å“åˆ—è¡¨ -->
   <view class="products-list">
     <view wx:for="{{products}}" wx:key="id" 
           wx:if="{{currentCategory === 'all' || item.category === currentCategory}}"
           class="product-item">
       
       <!-- çƒ­é—¨æ ‡ç­¾ -->
       <view wx:if="{{item.hot}}" class="hot-badge">ğŸ”¥ çƒ­é—¨</view>
       
       <view class="product-icon">
         <text class="icon-emoji">{{item.icon}}</text>
       </view>
       
       <view class="product-content">
         <view class="product-name">{{item.name}}</view>
         <view class="product-desc">{{item.desc}}</view>
         
         <view class="product-footer">
           <view class="product-price">
             <text class="price-value">{{item.points}}</text>
             <text class="price-unit">ç§¯åˆ†</text>
           </view>
           <view class="product-stock">
             <text wx:if="{{item.stock > 0}}">åº“å­˜ï¼š{{item.stock}}</text>
             <text wx:else class="out-of-stock">å·²å…‘å®Œ</text>
           </view>
         </view>
       </view>
       
       <button class="exchange-btn {{item.stock <= 0 || userPoints < item.points ? 'disabled' : ''}}" 
               bindtap="exchangeProduct" 
               data-id="{{item.id}}"
               disabled="{{item.stock <= 0 || userPoints < item.points}}">
         {{item.stock <= 0 ? 'å·²å…‘å®Œ' : userPoints < item.points ? 'ç§¯åˆ†ä¸è¶³' : 'å…‘æ¢'}}
       </button>
     </view>
   </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view wx:if="{{products.length === 0}}" class="empty-state">
    <text class="empty-icon">ğŸ</text>
    <view class="empty-text">æš‚æ— å•†å“</view>
    <view class="empty-hint">æ•¬è¯·æœŸå¾…æ›´å¤šç²¾å½©å•†å“</view>
  </view>

  <!-- ç§¯åˆ†è¯´æ˜ -->
  <view class="points-tips">
    <view class="tips-title">ğŸ’¡ ç§¯åˆ†è·å–æ–¹å¼</view>
    <view class="tips-list">
      <view class="tip-item">â€¢ æ¯æ—¥ç­¾åˆ°ï¼š10ç§¯åˆ†</view>
      <view class="tip-item">â€¢ è¿ç»­ç­¾åˆ°7å¤©ï¼šé¢å¤–5ç§¯åˆ†</view>
      <view class="tip-item">â€¢ é˜…è¯»æ–‡ç« ï¼š5ç§¯åˆ†/ç¯‡</view>
      <view class="tip-item">â€¢ AIå¯¹è¯å’¨è¯¢ï¼š2ç§¯åˆ†/æ¬¡</view>
    </view>
  </view>
</view>
